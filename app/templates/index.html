<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaskFlow - Smart Scheduling</title>
    <link rel="stylesheet" href="../static/style.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>🚀 TaskFlow</h1>
            <p>Smart Task Scheduling & Productivity Tracker</p>
        </div>

        <!-- Stats Dashboard -->
        <div class="stats-grid" id="statsGrid">
            <!-- Stats will be loaded here -->
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Task Management Panel -->
            <div class="panel">
                <h2>📋 Task Management</h2>
                
                <div class="tabs">
                    <div class="tab active" onclick="switchTab('add-task')">Add Task</div>
                    <div class="tab" onclick="switchTab('search-tasks')">Search Tasks</div>
                    <div class="tab" onclick="switchTab('schedule')">Schedule</div>
                </div>

                <!-- Add Task Tab -->
                <div class="tab-content active" id="add-task">
                    <div class="alert" id="taskAlert" style="display: none;"></div>
                    
                    <form id="taskForm" onsubmit="addTask(event)">
                        <div class="form-group">
                            <label for="taskTitle">Task Title *</label>
                            <input type="text" id="taskTitle" placeholder="Enter task title..." required>
                        </div>
                        
                        <div class="form-group">
                            <label for="estimatedTime">Estimated Time (minutes) *</label>
                            <input type="number" id="estimatedTime" value="30" min="1" max="1440" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="priority">Priority</label>
                            <select id="priority">
                                <option value="1">🔴 High Priority</option>
                                <option value="2" selected>🟡 Medium Priority</option>
                                <option value="3">🟢 Low Priority</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="deadline">Deadline (optional)</label>
                            <input type="date" id="deadline">
                        </div>
                        
                        <button type="submit" class="btn">
                            ➕ Add Task
                        </button>
                    </form>
                </div>

                <!-- Search Tasks Tab -->
                <div class="tab-content" id="search-tasks">
                    <div class="search-filters">
                        <input type="text" id="searchQuery" placeholder="Search tasks..." onkeyup="searchTasks()">
                        <select id="priorityFilter" onchange="searchTasks()">
                            <option value="">All Priorities</option>
                            <option value="1">High Priority</option>
                            <option value="2">Medium Priority</option>
                            <option value="3">Low Priority</option>
                        </select>
                        <select id="completedFilter" onchange="searchTasks()">
                            <option value="false">Active Tasks</option>
                            <option value="true">Completed Tasks</option>
                        </select>
                    </div>
                    <div id="searchResults">
                        <!-- Search results will appear here -->
                    </div>
                </div>

                <!-- Schedule Tab -->
                <div class="tab-content" id="schedule">
                    <div class="form-group">
                        <label for="availableTime">Available Time (minutes)</label>
                        <input type="number" id="availableTime" value="120" min="1">
                    </div>
                    <button type="button" class="btn" onclick="generateSchedule()">
                        ⚡ Generate Schedule
                    </button>
                    <div id="scheduleResults" style="margin-top: 20px;">
                        <!-- Schedule will appear here -->
                    </div>
                </div>
            </div>

            <!-- Task List Panel -->
            <div class="panel">
                <h2>📝 Active Tasks</h2>
                <div class="task-list" id="taskList">
                    <div class="loading">Loading tasks...</div>
                </div>
            </div>
        </div>

        <!-- Analytics Panel -->
        <div class="panel">
            <h2>📊 Analytics & Insights</h2>
            <div class="tabs">
                <div class="tab active" onclick="switchAnalyticsTab('overview')">Overview</div>
                <div class="tab" onclick="switchAnalyticsTab('user-stats')">User Stats</div>
                <div class="tab" onclick="switchAnalyticsTab('productivity')">Productivity</div>
            </div>

            <div class="tab-content active" id="overview">
                <div id="analyticsOverview">
                    <div class="loading">Loading analytics...</div>
                </div>
            </div>

            <div class="tab-content" id="user-stats">
                <div id="userStatsContent">
                    <div class="loading">Loading user statistics...</div>
                </div>
            </div>

            <div class="tab-content" id="productivity">
                <div id="productivityContent">
                    <div class="loading">Loading productivity data...</div>
                </div>
            </div>
        </div>

        <!-- Utility Panel -->
        <div class="panel" style="margin-top: 30px;">
            <h2>🛠️ Utilities</h2>
            <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                <button class="btn btn-secondary" onclick="exportData()">
                    📥 Export Data
                </button>
                <button class="btn btn-danger" onclick="confirmReset()">
                    🔄 Reset All Data
                </button>
                <button class="btn btn-secondary" onclick="testModels()">
                    🧪 Test Models
                </button>
                <button class="btn" onclick="loadDashboard()">
                    🔄 Refresh Dashboard
                </button>
            </div>
            <div id="utilityResults" style="margin-top: 15px;"></div>
        </div>
    </div>

    <!-- Modals -->
    <div class="modal" id="taskModal">
        <div class="modal-content">
            <h2 id="modalTitle">Edit Task</h2>
            <form id="editTaskForm" onsubmit="updateTask(event)">
                <input type="hidden" id="editTaskId">
                <div class="form-group">
                    <label for="editTaskTitle">Task Title *</label>
                    <input type="text" id="editTaskTitle" required>
                </div>
                <div class="form-group">
                    <label for="editEstimatedTime">Estimated Time (minutes) *</label>
                    <input type="number" id="editEstimatedTime" min="1" max="1440" required>
                </div>
                <div class="form-group">
                    <label for="editPriority">Priority</label>
                    <select id="editPriority">
                        <option value="1">🔴 High Priority</option>
                        <option value="2">🟡 Medium Priority</option>
                        <option value="3">🟢 Low Priority</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="editDeadline">Deadline (optional)</label>
                    <input type="date" id="editDeadline">
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="submit" class="btn">💾 Save Changes</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">❌ Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal" id="completeModal">
        <div class="modal-content">
            <h2>🎯 Complete Task</h2>
            <div id="completeTaskInfo"></div>
            <form id="completeTaskForm" onsubmit="completeTask(event)">
                <input type="hidden" id="completeTaskId">
                <div class="form-group">
                    <label for="actualTime">Actual Time Spent (minutes)</label>
                    <input type="number" id="actualTime" min="1" placeholder="Optional">
                </div>
                <div class="form-group">
                    <label for="focusSessions">Focus Sessions</label>
                    <input type="number" id="focusSessions" value="1" min="1">
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="submit" class="btn btn-success">✅ Complete Task</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">❌ Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../static/app.js"></script>
</body>
</html>